<div class="home-container">
  <!-- Welcome Section -->
  <section class="welcome-section py-5 mb-5">
    <div class="container">
      <div class="row">
        <div class="col-lg-8">
          <h1 class="display-4 fw-bold text-white mb-3">
           Wish List
          </h1>
          <p class="lead text-white-50 mb-4">Pick gifts you'd love to receive! Others can see your list.</p>
          <div class="button-group">
            <% if @wish_list_items.count < 10 %>
              <%= link_to "Add Item", new_wish_list_item_path, class: "btn btn-outline-solid btn-lg me-2" %>
            <% end %>
            <%= link_to "Back to Home", root_path, class: "btn btn-outline-solid btn-lg" %>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="container">
    <div class="row">
      <div class="col-12">
        <!-- Status Card -->
        <div class="card shadow-sm border-0 mb-4" style="background-color: #2a2a2a;">
          <div class="card-body" style="background-color: #2a2a2a; padding: 1.5rem;">
            <div class="row align-items-center">
              <div class="col-md-6">
                <h5 style="color: #e5e5e5; margin-bottom: 0.5rem;">Wish List Progress</h5>
                <p style="color: #999; margin-bottom: 0;">
                  <strong style="color: #667eea;"><%= @wish_list_items.count %>/10</strong> items added
                </p>
              </div>
              <div class="col-md-6">
                <div class="progress" style="height: 1.5rem; background-color: #1a1a1a; border: 1px solid #444;">
                  <div class="progress-bar" role="progressbar" style="width: <%= (@wish_list_items.count / 10.0) * 100 %>%; background-color: #667eea;" aria-valuenow="<%= @wish_list_items.count %>" aria-valuemin="0" aria-valuemax="10"></div>
                </div>
              </div>
            </div>
            <% if @wish_list_items.count >= 10 %>
              <div class="alert alert-warning mt-3 mb-0" style="background-color: #3d2a1a; border-color: #7a5c35; color: #ffd699;">
                <i class="bi bi-exclamation-triangle"></i> You've reached the maximum of 10 items in your wish list.
              </div>
            <% end %>
          </div>
        </div>

        <!-- Wish List Items -->
        <% if @wish_list_items.any? %>
          <div class="row g-2">
            <% @wish_list_items.each do |item| %>
              <div class="col-12">
                <div class="card shadow-sm border-0" style="background-color: #2a2a2a; border-color: #444;">
                  <div class="card-body" style="background-color: #2a2a2a; padding: 1.25rem;">
                    <div class="d-flex justify-content-between align-items-center gap-3">
                      <!-- Left side: Name and Description -->
                      <div style="flex: 1; min-width: 0;">
                        <h6 style="color: #e5e5e5; margin-bottom: 0.25rem; font-size: 1rem;">
                          <%= item.name %>
                        </h6>
                        <% if item.description.present? %>
                          <p style="color: #999; font-size: 0.85rem; margin-bottom: 0;">
                            <%= truncate(item.description, length: 100) %>
                          </p>
                        <% end %>
                      </div>

                      <!-- Middle: Price -->
                      <div style="text-align: center; white-space: nowrap;">
                        <small style="color: #666; text-transform: uppercase; display: block; font-size: 0.75rem;">Price</small>
                        <p style="color: #667eea; font-weight: 600; margin: 0; font-size: 1.1rem;">
                          <% if item.price.present? %>
                            $<%= number_with_precision(item.price, precision: 2) %>
                          <% else %>
                            <span style="color: #999; font-size: 0.9rem;">â€”</span>
                          <% end %>
                        </p>
                      </div>

                      <!-- Right side: Actions -->
                      <div style="display: flex; flex-direction: column; gap: 0.25rem; white-space: nowrap;">
                        <% if item.url.present? %>
                          <%= link_to "Store", item.url, target: "_blank", class: "btn btn-outline-solid btn-sm" %>
                        <% end %>
                        <div style="display: flex; gap: 0.5rem;">
                          <button type="button" class="btn btn-outline-solid btn-sm" data-bs-toggle="modal" data-bs-target="#editModal<%= item.id %>">Edit</button>
                          <%= link_to "Delete", wish_list_item_path(item), method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-outline-danger btn-sm" %>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Edit Modal -->
                <div class="modal fade" id="editModal<%= item.id %>" tabindex="-1" aria-labelledby="editModalLabel<%= item.id %>" aria-hidden="true">
                  <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content" style="background-color: #2a2a2a; border: 1px solid #444;">
                      <div class="modal-header" style="background-color: #667eea; border-bottom: 1px solid #444;">
                        <h5 class="modal-title text-white" id="editModalLabel<%= item.id %>">
                          <i class="bi bi-pencil-square"></i> Edit Item
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: brightness(0) invert(1);"></button>
                      </div>
                      <div class="modal-body" style="background-color: #2a2a2a; padding: 1.5rem;">
                        <%= form_with(model: item, local: true) do |form| %>
                          <% if item.errors.any? %>
                            <div class="alert alert-danger alert-dismissible fade show" role="alert" style="background-color: #3d1a1a; border-color: #7a3535; color: #ff9999;">
                              <strong><%= pluralize(item.errors.count, "error") %> prohibited this item from being saved:</strong>
                              <ul class="mb-0 mt-2">
                                <% item.errors.full_messages.each do |message| %>
                                  <li><%= message %></li>
                                <% end %>
                              </ul>
                            </div>
                          <% end %>

                          <div class="form-group mb-3">
                            <%= form.label :name, "Item Name", class: "form-label", style: "color: #e5e5e5; font-weight: 600;" %>
                            <%= form.text_field :name, required: true, class: "form-control", style: "background-color: #1a1a1a; border: 1px solid #444; color: #e5e5e5;" %>
                          </div>

                          <div class="form-group mb-3">
                            <%= form.label :description, "Description", class: "form-label", style: "color: #e5e5e5; font-weight: 600;" %>
                            <%= form.text_area :description, rows: 3, class: "form-control", style: "background-color: #1a1a1a; border: 1px solid #444; color: #e5e5e5;" %>
                          </div>

                          <div class="form-group mb-3">
                            <%= form.label :url, "Product Link (Optional)", class: "form-label", style: "color: #e5e5e5; font-weight: 600;" %>
                            <%= form.url_field :url, class: "form-control", style: "background-color: #1a1a1a; border: 1px solid #444; color: #e5e5e5;" %>
                          </div>

                          <div class="form-group mb-3">
                            <%= form.label :price, "Price (Optional)", class: "form-label", style: "color: #e5e5e5; font-weight: 600;" %>
                            <div class="input-group">
                              <span class="input-group-text" style="background-color: #1a1a1a; border: 1px solid #444; color: #e5e5e5;">$</span>
                              <%= form.number_field :price, step: 0.01, min: 0, class: "form-control", style: "background-color: #1a1a1a; border: 1px solid #444; color: #e5e5e5;" %>
                            </div>
                          </div>

                          <div class="d-grid gap-2">
                            <%= form.submit "Save Changes", class: "btn btn-outline-solid" %>
                          </div>
                        <% end %>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
          <div class="card shadow-sm border-0" style="background-color: #2a2a2a;">
            <div class="card-body text-center py-5" style="background-color: #2a2a2a;">
              <i class="bi bi-inbox" style="font-size: 3rem; color: white; margin-bottom: 1rem; display: block;"></i>
              <h5 style="color: #e5e5e5; margin-bottom: 1rem;">Your wish list is empty</h5>
              <p style="color: #999; margin-bottom: 1.5rem;">Start adding items you'd like to receive as gifts</p>
              <%= link_to "Add Your First Item", new_wish_list_item_path, class: "btn btn-outline-solid" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<style>
  .progress-bar {
    transition: width 0.6s ease;
  }
</style>
